{% extends "base.html" %}

{% block title %}BlogForge - Unified CMS{% endblock %}

{% block head %}
    <!-- Additional styles specific to homepage can go here -->
{% endblock %}

{% block content %}

    <!-- Main Content -->
    <div class="flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="content-area">
            <div class="max-w-7xl mx-auto">
                <!-- Hero Section -->
                <section class="hero-section mb-12">
                    <div class="text-center">
                        <h1 class="text-4xl font-bold text-white mb-4">BlogForge CMS</h1>
                        <p class="text-xl text-dark-accent mb-8">Unified Content Management & AI-Powered Publishing</p>
                    </div>
                </section>

                <!-- Content Creation Workflow -->
                <section class="mb-12">
                    <h2 class="text-2xl section-title mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-sitemap"></i> Content Creation Workflow
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Planning -->
                        <div class="card-dark rounded-xl p-6">
                            <div class="flex flex-col items-center gap-2 mb-4">
                                <span class="icon-circle"><i class="fa-solid fa-lightbulb text-yellow-400 text-xl"></i></span>
                                <span class="text-lg font-semibold text-white">Planning</span>
                                <p class="text-dark-accent text-sm text-center">Outline your post structure and key points</p>
                            </div>
                            <div class="flex flex-col gap-2 mt-4">
                                <a href="/workflow/posts/{{ first_post_id }}/planning/idea"
                                    class="text-dark-accent hover:text-white text-sm text-center transition">Idea</a>
                                <a href="/workflow/posts/{{ first_post_id }}/planning/research"
                                    class="text-dark-accent hover:text-white text-sm text-center transition">Research</a>
                                <a href="/workflow/posts/{{ first_post_id }}/planning/structure"
                                    class="text-dark-accent hover:text-white text-sm text-center transition">Structure</a>
                            </div>
                        </div>
                        
                        <!-- Authoring -->
                        <div class="card-dark rounded-xl p-6">
                            <div class="flex flex-col items-center gap-2 mb-4">
                                <span class="icon-circle"><i class="fa-solid fa-pen-nib text-green-400 text-xl"></i></span>
                                <span class="text-lg font-semibold text-white">Authoring</span>
                                <p class="text-dark-accent text-sm text-center">Write and enhance your content with AI</p>
                            </div>
                            <div class="flex flex-col gap-2 mt-4">
                                <a href="/workflow/posts/{{ first_post_id }}/writing/content"
                                    class="text-dark-accent hover:text-white text-sm text-center transition">Sections</a>
                                <a href="/workflow/posts/{{ first_post_id }}/writing/post_info"
                                    class="text-dark-accent hover:text-white text-sm text-center transition">Post Info</a>
                                <a href="/workflow/posts/{{ first_post_id }}/writing/images"
                                    class="text-dark-accent hover:text-white text-sm text-center transition">Images</a>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Publication & Distribution -->
                <section class="mb-12">
                    <h2 class="text-2xl section-title mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-paper-plane"></i> Publication & Distribution
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Launchpad Syndication -->
                        <a href="/launchpad/" class="block group">
                            <div class="card-dark rounded-xl p-6 transition flex flex-col items-center gap-2 group-hover:border-dark-accent">
                                <span class="icon-circle"><i class="fa-solid fa-share-nodes text-blue-400 text-xl"></i></span>
                                <span class="text-lg font-semibold text-white">Launchpad</span>
                                <p class="text-dark-accent text-sm text-center">Multi-platform content syndication and publishing</p>
                            </div>
                        </a>
                        
                        <!-- Content Management -->
                        <a href="/post-sections/" class="block group">
                            <div class="card-dark rounded-xl p-6 transition flex flex-col items-center gap-2 group-hover:border-dark-accent">
                                <span class="icon-circle"><i class="fa-solid fa-file-lines text-green-400 text-xl"></i></span>
                                <span class="text-lg font-semibold text-white">Content Manager</span>
                                <p class="text-dark-accent text-sm text-center">Manage posts, sections, and metadata</p>
                            </div>
                        </a>
                    </div>
                </section>

                <!-- Social Media Operations -->
                <section class="mb-12">
                    <h2 class="text-2xl section-title mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-rocket"></i> Social Media Operations
                    </h2>
                    <div class="grid grid-cols-1 gap-6">
                        <a href="/launchpad/" class="block group">
                            <div class="card-dark rounded-xl p-8 transition flex flex-col items-center gap-4 group-hover:border-dark-accent bg-gradient-to-r from-blue-900/20 to-purple-900/20 border-2 border-blue-500/30">
                                <div class="flex items-center gap-4">
                                    <span class="icon-circle bg-gradient-to-r from-blue-500 to-purple-500"><i class="fa-solid fa-rocket text-white text-2xl"></i></span>
                                    <div class="text-center">
                                        <h3 class="text-2xl font-bold text-white mb-2">Social Media Launchpad</h3>
                                        <p class="text-dark-accent text-lg">Centralized hub for all social media publishing and syndication</p>
                                    </div>
                                </div>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 w-full mt-4">
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-white" id="homepage-scheduled-count">-</div>
                                        <div class="text-dark-accent text-sm">Scheduled Posts</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-white" id="homepage-published-count">-</div>
                                        <div class="text-dark-accent text-sm">Published Today</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-white" id="homepage-platforms-count">-</div>
                                        <div class="text-dark-accent text-sm">Active Platforms</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-white" id="homepage-queue-health">-</div>
                                        <div class="text-dark-accent text-sm">Queue Health</div>
                                    </div>
                                </div>
                                <div class="mt-4 text-dark-accent text-sm">
                                    <i class="fa-solid fa-arrow-right"></i> Manage Facebook posts, blog syndication, and publishing workflows
                                </div>
                            </div>
                        </a>
                    </div>
                </section>

                <!-- AI & Automation -->
                <section class="mb-12">
                    <h2 class="text-2xl section-title mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-robot"></i> AI & Automation
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- LLM Actions -->
                        <a href="/llm-actions/" class="block group">
                            <div class="card-dark rounded-xl p-6 transition flex flex-col items-center gap-2 group-hover:border-dark-accent">
                                <span class="icon-circle"><i class="fa-solid fa-brain text-pink-400 text-xl"></i></span>
                                <span class="text-lg font-semibold text-white">LLM Actions</span>
                                <p class="text-dark-accent text-sm text-center">AI-powered content generation and processing</p>
                            </div>
                        </a>
                        
                        <!-- Image Generation -->
                        <a href="/images/" class="block group">
                            <div class="card-dark rounded-xl p-6 transition flex flex-col items-center gap-2 group-hover:border-dark-accent">
                                <span class="icon-circle"><i class="fa-solid fa-image text-purple-400 text-xl"></i></span>
                                <span class="text-lg font-semibold text-white">Image Studio</span>
                                <p class="text-dark-accent text-sm text-center">AI image generation and management</p>
                            </div>
                        </a>
                        
                        <!-- Clan API -->
                        <a href="/clan-api/" class="block group">
                            <div class="card-dark rounded-xl p-6 transition flex flex-col items-center gap-2 group-hover:border-dark-accent">
                                <span class="icon-circle"><i class="fa-solid fa-shopping-cart text-orange-400 text-xl"></i></span>
                                <span class="text-lg font-semibold text-white">Product Integration</span>
                                <p class="text-dark-accent text-sm text-center">External product data and e-commerce</p>
                            </div>
                        </a>
                    </div>
                </section>

                <!-- System Management -->
                <section class="mb-12">
                    <h2 class="text-2xl section-title mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-cogs"></i> System Management
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Database -->
                        <a href="/db/" class="block group">
                            <div class="card-dark rounded-xl p-6 transition flex flex-col items-center gap-2 group-hover:border-dark-accent">
                                <span class="icon-circle"><i class="fa-solid fa-database text-cyan-400 text-xl"></i></span>
                                <span class="text-lg font-semibold text-white">Database</span>
                                <p class="text-dark-accent text-sm text-center">Manage schemas, data, and migrations</p>
                            </div>
                        </a>
                        
                        <!-- Documentation -->
                        <a href="/docs/" class="block group">
                            <div class="card-dark rounded-xl p-6 transition flex flex-col items-center gap-2 group-hover:border-dark-accent">
                                <span class="icon-circle"><i class="fa-solid fa-book text-indigo-400 text-xl"></i></span>
                                <span class="text-lg font-semibold text-white">Documentation</span>
                                <p class="text-dark-accent text-sm text-center">System documentation and guides</p>
                            </div>
                        </a>
                    </div>
                </section>

                <!-- Quick Stats Dashboard -->
                <section class="mb-12">
                    <h2 class="text-2xl section-title mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-chart-line"></i> Quick Stats
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="card-dark rounded-xl p-6 text-center">
                            <div class="text-3xl font-bold text-white mb-2">{{ post_count or 0 }}</div>
                            <div class="text-dark-accent text-sm">Total Posts</div>
                        </div>
                        <div class="card-dark rounded-xl p-6 text-center">
                            <div class="text-3xl font-bold text-white mb-2">{{ image_count or 0 }}</div>
                            <div class="text-dark-accent text-sm">Images</div>
                        </div>
                        <div class="card-dark rounded-xl p-6 text-center">
                            <div class="text-3xl font-bold text-white mb-2">{{ workflow_count or 0 }}</div>
                            <div class="text-dark-accent text-sm">Workflows</div>
                        </div>
                        <div class="card-dark rounded-xl p-6 text-center">
                            <div class="text-3xl font-bold text-white mb-2">{{ llm_count or 0 }}</div>
                            <div class="text-dark-accent text-sm">AI Interactions</div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        async function loadPosts() {
            try {
                const response = await fetch('/posts');
                if (response.ok) {
                    const content = await response.text();
                    document.querySelector('.content-area').innerHTML = content;
                } else {
                    alert('Posts service unavailable');
                }
            } catch (error) {
                alert('Error loading posts: ' + error.message);
            }
        }

        async function loadDocs() {
            try {
                const response = await fetch('/docs/');
                if (response.ok) {
                    const content = await response.text();
                    document.querySelector('.content-area').innerHTML = content;
                } else {
                    alert('Docs service unavailable');
                }
            } catch (error) {
                alert('Error loading docs: ' + error.message);
            }
        }

        // Load Social Media KPIs for homepage
        async function loadSocialMediaKPIs() {
            try {
                const response = await fetch('/launchpad/api/queue');
                if (response.ok) {
                    const data = await response.json();
                    const timeline = data.timeline || [];
                    
                    // Calculate KPIs
                    const scheduled = timeline.filter(item => item.status === 'pending' || item.status === 'ready').length;
                    const published = timeline.filter(item => item.status === 'published').length;
                    const platforms = [...new Set(timeline.map(item => item.platform))].length;
                    const queueHealth = timeline.length > 0 ? Math.min(100, (timeline.length / 50) * 100) : 0;
                    
                    // Update homepage KPI elements
                    const scheduledEl = document.getElementById('homepage-scheduled-count');
                    const publishedEl = document.getElementById('homepage-published-count');
                    const platformsEl = document.getElementById('homepage-platforms-count');
                    const queueHealthEl = document.getElementById('homepage-queue-health');
                    
                    if (scheduledEl) scheduledEl.textContent = scheduled;
                    if (publishedEl) publishedEl.textContent = published;
                    if (platformsEl) platformsEl.textContent = platforms;
                    if (queueHealthEl) queueHealthEl.textContent = Math.round(queueHealth) + '%';
                }
            } catch (error) {
                console.log('Error loading social media KPIs:', error);
            }
        }

        // Load KPIs when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadSocialMediaKPIs();
        });
    </script>
{% endblock %}
