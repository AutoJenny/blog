<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facebook Settings - Social Media Syndication - Blog Launchpad</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="/static/css/launchpad.css?v=1">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <style>
        .platform-tab {
            background-color: #dd6707 !important;
        }
        div.platform-tab.status-undeveloped {
            background-color: #000000 !important;
        }
        div.platform-tab.status-developed {
            background-color: #f8f9fa !important;
        }
        div.platform-tab.status-active {
            background-color: #ffffff !important;
        }
        
        /* CRUD Editing Styles */
        .clickable-edit {
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            padding: 4px 8px;
            border-radius: 4px;
        }
        
        .clickable-edit:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }
        
        .edit-icon {
            opacity: 0.6;
            font-size: 0.8em;
            transition: opacity 0.2s ease;
        }
        
        .clickable-edit:hover .edit-icon {
            opacity: 1;
            color: #17a2b8;
        }
        
        .spec-item.editing {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            padding: 8px;
            margin: 4px 0;
        }
        
        .edit-input {
            background-color: #343a40;
            border: 1px solid #495057;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            width: 100%;
            font-size: 0.9em;
        }
        
        .edit-input:focus {
            outline: none;
            border-color: #17a2b8;
            box-shadow: 0 0 0 2px rgba(23, 162, 184, 0.25);
        }
        
        .edit-buttons {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }
        
        .edit-btn {
            padding: 4px 12px;
            font-size: 0.8em;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .save-btn {
            background-color: #28a745;
            color: white;
        }
        
        .save-btn:hover {
            background-color: #218838;
        }
        
        .cancel-btn {
            background-color: #6c757d;
            color: white;
        }
        
        .cancel-btn:hover {
            background-color: #5a6268;
        }
        
        .delete-btn {
            background-color: #dc3545;
            color: white;
        }
        
        .delete-btn:hover {
            background-color: #c82333;
        }
        

        
        /* Edit Form Styles */
        .edit-form {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            padding: 12px;
            margin: 8px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .edit-row {
            margin-bottom: 12px;
        }
        
        .edit-label {
            display: block;
            color: #a5b4fc;
            font-weight: 600;
            margin-bottom: 4px;
            font-size: 0.9em;
        }
        
        .edit-input.edit-key {
            background-color: #495057;
            color: #adb5bd;
            cursor: not-allowed;
        }
        
        .edit-input.edit-value {
            background-color: #343a40;
            color: white;
        }
        
        /* Accordion button indicators */
        .accordion-button::after {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23ffffff'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e");
            transition: transform 0.2s ease-in-out;
        }
        
        .accordion-button:not(.collapsed)::after {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23ffffff'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e");
            transform: rotate(180deg);
        }
    </style>
</head>
<body class="bg-dark">
    <!-- Header -->
    <header class="bg-dark shadow-lg border-bottom py-3">
        <nav class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    <!-- Logo and Title -->
                    <a href="http://localhost:5000/" class="d-flex align-items-center text-white text-decoration-none me-4">
                        <img src="http://localhost:5000/static/images/site/brand-logo.png" alt="BlogForge Logo" class="rounded-circle shadow me-2" style="background:#23273a; width: 40px; height: 40px;" />
                        <span class="fw-bold text-white fs-3">BlogForge</span>
                    </a>
                </div>
                <div class="d-flex align-items-center">
                    <!-- Modules Dropdown -->
                    <div class="dropdown me-3">
                        <button class="btn btn-outline-light dropdown-toggle" type="button" id="modulesDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-cubes me-1"></i> Modules
                        </button>
                        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="modulesDropdown">
                            <li><a class="dropdown-item" href="http://localhost:5000/db/"><i class="fas fa-cogs text-purple me-2"></i>Database</a></li>
                            <li><a class="dropdown-item" href="http://localhost:5000/llm/"><i class="fas fa-brain text-pink me-2"></i>AI</a></li>
                            <li><a class="dropdown-item" href="http://localhost:5000/llm/images"><i class="fas fa-image text-info me-2"></i>Images</a></li>
                            <li><a class="dropdown-item" href="http://localhost:5000/servers/"><i class="fas fa-server text-success me-2"></i>Servers</a></li>
                        </ul>
                    </div>
                    <div class="d-flex align-items-center">
                        <a href="http://localhost:5000/posts" class="btn btn-link text-white text-decoration-none me-3">Posts</a>
                        <a href="http://localhost:5000/workflow/" class="btn btn-link text-white text-decoration-none">Workflow</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-rocket me-2"></i>Blog Launchpad
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/">Dashboard</a>
                <a class="nav-link" href="/cross-promotion">Cross Promotion</a>
                <a class="nav-link" href="/publishing">Publishing</a>
                <a class="nav-link active" href="/syndication">Syndication</a>
                <a class="nav-link" href="/test-api">API Test</a>
            </div>
        </div>
    </nav>

    <!-- Syndication Header -->
    <div class="publishing-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-12">
                    <h2 class="mb-2">
                        <i class="fab fa-facebook me-3"></i>Facebook Platform Settings
                    </h2>
                    <p class="mb-0 opacity-75">Priority 1 - Text posts with images</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row">
            {% include 'includes/platform_sidebar.html' %}
            
            <!-- Right Content Area -->
            <div class="col-md-9">
                <div class="platform-content">
                    <div class="row">
                        <!-- Left Column -->
                        <div class="col-md-6">
                            <!-- Content Specifications -->
                            <div class="spec-card">
                                <div class="accordion" id="contentSpecsAccordion">
                                    <div class="accordion-item bg-dark border-secondary">
                                        <h2 class="accordion-header" id="contentSpecsHeader">
                                            <button class="accordion-button collapsed bg-dark text-white border-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#contentSpecsCollapse" aria-expanded="false" aria-controls="contentSpecsCollapse">
                                                <i class="fas fa-file-alt me-2"></i>Content Specifications
                                            </button>
                                        </h2>
                                        <div id="contentSpecsCollapse" class="accordion-collapse collapse" aria-labelledby="contentSpecsHeader" data-bs-parent="#contentSpecsAccordion">
                                            <div class="accordion-body text-white">
                                    {% if platform.specifications.content %}
                                        {% for spec in platform.specifications.content %}
                                        <div class="spec-item" data-spec-id="{{ spec.id }}" data-category="content" data-key="{{ spec.spec_key }}">
                                            <span class="spec-label">{{ spec.spec_key|replace('_', ' ')|title }}:</span>
                                            <span class="spec-value clickable-edit" data-spec-id="{{ spec.id }}" data-category="content" data-key="{{ spec.spec_key }}">
                                                {{ spec.spec_value }}
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        {% endfor %}
                                    {% else %}
                                        <div class="spec-item" data-category="content" data-key="content_type">
                                            <span class="spec-label">Content Type:</span>
                                            <span class="spec-value clickable-edit" data-category="content" data-key="content_type">
                                                Text posts with images
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="content" data-key="character_target">
                                            <span class="spec-label">Character Target:</span>
                                            <span class="spec-value clickable-edit" data-category="content" data-key="character_target">
                                                ‚â§63,206 characters
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="content" data-key="style_tone">
                                            <span class="spec-label">Style/Tone:</span>
                                            <span class="spec-value clickable-edit" data-category="content" data-key="style_tone">
                                                Conversational, engaging, authentic
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="content" data-key="posting_frequency">
                                            <span class="spec-label">Posting Frequency:</span>
                                            <span class="spec-value clickable-edit" data-category="content" data-key="posting_frequency">
                                                1-2 posts per day (optimal)
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="content" data-key="optimal_timing">
                                            <span class="spec-label">Optimal Timing:</span>
                                            <span class="spec-value clickable-edit" data-category="content" data-key="optimal_timing">
                                                1-3 PM, 7-9 PM (local time)
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="content" data-key="priority_level">
                                            <span class="spec-label">Priority Level:</span>
                                            <span class="spec-value clickable-edit" data-category="content" data-key="priority_level">
                                                1 (Highest)
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="content" data-key="example_cta">
                                            <span class="spec-label">Example CTA:</span>
                                            <span class="spec-value clickable-edit" data-category="content" data-key="example_cta">
                                                "Read the full story in the link below üëá"
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                    {% endif %}

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Image Requirements -->
                            <div class="spec-card">
                                <div class="accordion" id="imageReqsAccordion">
                                    <div class="accordion-item bg-dark border-secondary">
                                        <h2 class="accordion-header" id="imageReqsHeader">
                                            <button class="accordion-button collapsed bg-dark text-white border-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#imageReqsCollapse" aria-expanded="false" aria-controls="imageReqsCollapse">
                                                <i class="fas fa-image me-2"></i>Image Requirements
                                            </button>
                                        </h2>
                                        <div id="imageReqsCollapse" class="accordion-collapse collapse" aria-labelledby="imageReqsHeader" data-bs-parent="#imageReqsAccordion">
                                            <div class="accordion-body text-white">
                                    {% if platform.specifications.image %}
                                        {% for spec in platform.specifications.image %}
                                        <div class="spec-item" data-spec-id="{{ spec.id }}" data-category="image" data-key="{{ spec.spec_key }}">
                                            <span class="spec-label">{{ spec.spec_key|replace('_', ' ')|title }}:</span>
                                            <span class="spec-value clickable-edit" data-spec-id="{{ spec.id }}" data-category="image" data-key="{{ spec.spec_key }}">
                                                {{ spec.spec_value }}
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        {% endfor %}
                                    {% else %}
                                        <div class="spec-item" data-category="image" data-key="dimensions">
                                            <span class="spec-label">Dimensions:</span>
                                            <span class="spec-value clickable-edit" data-category="image" data-key="dimensions">
                                                1200√ó630 (landscape)
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="image" data-key="aspect_ratio">
                                            <span class="spec-label">Aspect Ratio:</span>
                                            <span class="spec-value clickable-edit" data-category="image" data-key="aspect_ratio">
                                                1.91:1
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="image" data-key="format">
                                            <span class="spec-label">Format:</span>
                                            <span class="spec-value clickable-edit" data-category="image" data-key="format">
                                                JPG, PNG, GIF
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="image" data-key="file_size">
                                            <span class="spec-label">File Size:</span>
                                            <span class="spec-value clickable-edit" data-category="image" data-key="file_size">
                                                Max 30MB
                                                <i class="spec-value clickable-edit" data-category="image" data-key="file_size">
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="image" data-key="quality">
                                            <span class="spec-label">Quality:</span>
                                            <span class="spec-value clickable-edit" data-category="image" data-key="quality">
                                                High resolution, mobile-optimized
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="image" data-key="style">
                                            <span class="spec-label">Style:</span>
                                            <span class="spec-value clickable-edit" data-category="image" data-key="style">
                                                Authentic, engaging, shareable
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                    {% endif %}

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column -->
                        <div class="col-md-6">
                            <!-- Content Adaptation -->
                            <div class="spec-card">
                                <div class="accordion" id="contentAdaptationAccordion">
                                    <div class="accordion-item bg-dark border-secondary">
                                        <h2 class="accordion-header" id="contentAdaptationHeader">
                                            <button class="accordion-button collapsed bg-dark text-white border-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#contentAdaptationCollapse" aria-expanded="false" aria-controls="contentAdaptationCollapse">
                                                <i class="fas fa-magic me-2"></i>Content Adaptation
                                            </button>
                                        </h2>
                                        <div id="contentAdaptationCollapse" class="accordion-collapse collapse" aria-labelledby="contentAdaptationHeader" data-bs-parent="#contentAdaptationAccordion">
                                            <div class="accordion-body text-white">
                                    {% if platform.specifications.adaptation %}
                                        {% for spec in platform.specifications.adaptation %}
                                        <div class="spec-item" data-spec-id="{{ spec.id }}" data-category="adaptation" data-key="{{ spec.spec_key }}">
                                            <span class="spec-label">{{ spec.spec_key|replace('_', ' ')|title }}:</span>
                                            <span class="spec-value clickable-edit" data-spec-id="{{ spec.id }}" data-category="adaptation" data-key="{{ spec.spec_key }}">
                                                {{ spec.spec_value }}
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        {% endfor %}
                                    {% else %}
                                        <div class="spec-item" data-category="adaptation" data-key="text_processing">
                                            <span class="spec-label">Text Processing:</span>
                                            <span class="spec-value clickable-edit" data-category="adaptation" data-key="text_processing">
                                                Optimize for engagement, not truncation
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="adaptation" data-key="tone_adjustment">
                                            <span class="spec-label">Tone Adjustment:</span>
                                            <span class="spec-value clickable-edit" data-category="adaptation" data-key="tone_adjustment">
                                                Authentic, conversational, community-focused
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="adaptation" data-key="hashtag_strategy">
                                            <span class="spec-label">Hashtag Strategy:</span>
                                            <span class="spec-value clickable-edit" data-category="adaptation" data-key="hashtag_strategy">
                                                2-3 relevant hashtags (Facebook prefers fewer)
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="adaptation" data-key="cta_generation">
                                            <span class="spec-label">CTA Generation:</span>
                                            <span class="spec-value clickable-edit" data-category="adaptation" data-key="cta_generation">
                                                Ask questions, encourage discussion
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="adaptation" data-key="content_focus">
                                            <span class="spec-label">Content Focus:</span>
                                            <span class="spec-value clickable-edit" data-category="adaptation" data-key="content_focus">
                                                Scottish heritage, storytelling, community
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                    {% endif %}
                                    <div class="spec-item" data-category="adaptation" data-key="engagement">
                                        <span class="spec-label">Engagement:</span>
                                        <span class="spec-value clickable-edit" data-category="adaptation" data-key="engagement">
                                            Polls, questions, tag friends
                                            <i class="fas fa-edit edit-icon ms-2"></i>
                                        </span>
                                    </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- API Integration -->
                            <div class="spec-card">
                                <div class="accordion" id="apiIntegrationAccordion">
                                    <div class="accordion-item bg-dark border-secondary">
                                        <h2 class="accordion-header" id="apiIntegrationHeader">
                                            <button class="accordion-button collapsed bg-dark text-white border-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#apiIntegrationCollapse" aria-expanded="false" aria-controls="apiIntegrationCollapse">
                                                <i class="fas fa-code me-2"></i>API Integration
                                            </button>
                                        </h2>
                                        <div id="apiIntegrationCollapse" class="accordion-collapse collapse" aria-labelledby="apiIntegrationHeader" data-bs-parent="#apiIntegrationAccordion">
                                            <div class="accordion-body text-white">
                                    {% if platform.specifications.api %}
                                        {% for spec in platform.specifications.api %}
                                        <div class="spec-item" data-spec-id="{{ spec.id }}" data-category="api" data-key="{{ spec.spec_key }}">
                                            <span class="spec-label">{{ spec.spec_key|replace('_', ' ')|title }}:</span>
                                            <span class="spec-value clickable-edit" data-spec-id="{{ spec.id }}" data-category="api" data-key="{{ spec.spec_key }}">
                                                {{ spec.spec_value }}
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        {% endfor %}
                                    {% else %}
                                        <div class="spec-item" data-category="api" data-key="api_name">
                                            <span class="spec-label">API:</span>
                                            <span class="spec-value clickable-edit" data-category="api" data-key="api_name">
                                                Facebook Graph API v18.0+
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="api" data-key="authentication">
                                            <span class="spec-label">Authentication:</span>
                                            <span class="spec-value clickable-edit" data-category="api" data-key="authentication">
                                                OAuth 2.0 with App Review
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="api" data-key="rate_limits">
                                            <span class="spec-label">Rate Limits:</span>
                                            <span class="spec-value clickable-edit" data-category="api" data-key="rate_limits">
                                                200 posts per hour per user
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="api" data-key="endpoints">
                                            <span class="spec-label">Endpoints:</span>
                                            <span class="spec-value clickable-edit" data-category="api" data-key="endpoints">
                                                /me/feed, /page/feed
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="api" data-key="permissions">
                                            <span class="spec-label">Permissions:</span>
                                            <span class="spec-value clickable-edit" data-category="api" data-key="permissions">
                                                pages_manage_posts, publish_to_groups
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                        <div class="spec-item" data-category="api" data-key="status">
                                            <span class="spec-label">Status:</span>
                                            <span class="spec-value clickable-edit" data-category="api" data-key="status">
                                                Requires App Review approval
                                                <i class="fas fa-edit edit-icon ms-2"></i>
                                            </span>
                                        </div>
                                    {% endif %}

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>



                    <!-- Content Process Selection -->
                    <div class="spec-card mt-3">
                        <div class="accordion" id="contentProcessSelectionAccordion">
                            <div class="accordion-item bg-dark border-secondary">
                                <h2 class="accordion-header" id="contentProcessSelectionHeader">
                                    <button class="accordion-button bg-dark text-white border-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#contentProcessSelectionCollapse" aria-expanded="true" aria-controls="contentProcessSelectionCollapse">
                                        <i class="fas fa-cogs me-2"></i>Content Process Selection
                                    </button>
                                </h2>
                                <div id="contentProcessSelectionCollapse" class="accordion-collapse collapse show" aria-labelledby="contentProcessSelectionHeader" data-bs-parent="#contentProcessSelectionAccordion">
                                    <div class="accordion-body text-white">
                                        <div class="row">
                                            <div class="col-12">
                                                <div class="spec-item">
                                                    <span class="spec-label">Select Content Process:</span>
                                                    <div class="mt-2">
                                                        <select id="content-process-selector" class="form-select bg-dark text-white border-secondary" style="max-width: 300px;">
                                                            <option value="facebook_feed_post" selected>üìù Feed Post - Standard text + image posts</option>
                                                            <option value="facebook_story_post">üì± Story Post - Short-form, visual content</option>
                                                            <option value="facebook_reels_caption">üé¨ Reels Caption - Video content with captions</option>
                                                            <option value="facebook_group_post">üë• Group Post - Community-focused content</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="spec-item mt-3">
                                                    <span class="spec-label">Process Description:</span>
                                                    <div id="process-description" class="mt-2 p-3 bg-secondary rounded">
                                                        <strong>Feed Post:</strong> Standard Facebook text + image posts with conversational tone. Optimized for engagement and sharing with character limits up to 63,206 characters.
                                                    </div>
                                                </div>
                                                <div class="spec-item mt-3">
                                                    <span class="spec-label">Current Configuration:</span>
                                                    <div id="process-config-preview" class="mt-2 p-3 bg-secondary rounded">
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <strong>LLM Prompts:</strong> Configured<br>
                                                                <strong>Constraints:</strong> 63,206 characters max<br>
                                                                <strong>Style Guide:</strong> Conversational, engaging
                                                            </div>
                                                            <div class="col-md-6">
                                                                <strong>Hashtag Strategy:</strong> 2-3 relevant tags<br>
                                                                <strong>CTA Examples:</strong> Multiple options<br>
                                                                <strong>Status:</strong> ‚úÖ Ready for use
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Process Configuration Panel -->
                    <div class="spec-card mt-3">
                        <div class="accordion" id="processConfigurationAccordion">
                            <div class="accordion-item bg-dark border-secondary">
                                <h2 class="accordion-header" id="processConfigurationHeader">
                                    <button class="accordion-button bg-dark text-white border-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#processConfigurationCollapse" aria-expanded="true" aria-controls="processConfigurationCollapse">
                                        <i class="fas fa-cogs me-2"></i>Process Configuration
                                    </button>
                                </h2>
                                <div id="processConfigurationCollapse" class="accordion-collapse collapse show" aria-labelledby="processConfigurationHeader" data-bs-parent="#processConfigurationAccordion">
                                    <div class="accordion-body text-white">
                                        <div class="row mb-3">
                                            <div class="col-12">
                                                <div class="d-flex align-items-center">
                                                    <span class="spec-label me-3">Development Status:</span>
                                                    <div class="form-check form-switch">
                                                        <input class="form-check-input" type="checkbox" id="developedToggle" style="width: 3rem; height: 1.5rem;">
                                                        <label class="form-check-label ms-2" for="developedToggle">
                                                            <span id="developedStatusText">Not Developed</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div id="processConfigsContainer">
                                            <div class="text-center text-muted py-4">
                                                <i class="fas fa-info-circle me-2"></i>Select a content process above to view and edit its configuration
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const platformTabs = document.querySelectorAll('.platform-tab');
            
            // Handle platform tab clicks
            platformTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const platform = this.getAttribute('data-platform');
                    if (platform !== 'facebook') {
                        window.location.href = `/syndication/platform-settings/${platform}`;
                    }
                });
            });
            
            // Force colors with JavaScript
            document.querySelectorAll('.status-undeveloped').forEach(tab => {
                tab.style.backgroundColor = '#000000';
                // Darker text and icons for undeveloped
                const text = tab.querySelector('.platform-name');
                const icon = tab.querySelector('.platform-icon');
                if (text) text.style.color = '#666666';
                if (icon) icon.style.filter = 'brightness(0) invert(0.4)';
            });
            document.querySelectorAll('.status-developed').forEach(tab => {
                tab.style.backgroundColor = '#f8f9fa';
                // Black text and icons for developed
                const text = tab.querySelector('.platform-name');
                const icon = tab.querySelector('.platform-icon');
                if (text) text.style.color = '#000000';
                if (icon) icon.style.filter = 'brightness(0) invert(0)';
            });
            document.querySelectorAll('.status-active').forEach(tab => {
                tab.style.backgroundColor = '#ffffff';
                // Black text and icons for active
                const text = tab.querySelector('.platform-name');
                const icon = tab.querySelector('.platform-icon');
                if (text) text.style.color = '#000000';
                if (icon) icon.style.filter = 'brightness(0) invert(0)';
                // Green status indicator
                const indicator = tab.querySelector('.status-indicator');
                if (indicator) indicator.style.backgroundColor = '#10b981';
            });
            

            

            
            // CRUD Functionality for Specifications
            let editingSpec = null;
            
            // Handle clicking on specification values for editing
            document.addEventListener('click', function(e) {
                if (e.target.closest('.clickable-edit')) {
                    const specElement = e.target.closest('.clickable-edit');
                    const specItem = specElement.closest('.spec-item');
                    const specId = specElement.dataset.specId;
                    const category = specElement.dataset.category;
                    const key = specElement.dataset.key;
                    const currentValue = specElement.textContent.trim().replace('‚úèÔ∏è', '').trim();
                    
                    if (editingSpec) {
                        // Cancel any existing edit
                        cancelEdit();
                    }
                    
                    startEdit(specItem, specId, category, key, currentValue);
                }
            });
            

            
            function startEdit(specItem, specId, category, key, currentValue) {
                editingSpec = { specItem, specId, category, key, currentValue };
                
                // Create edit form
                const editForm = document.createElement('div');
                editForm.className = 'edit-form';
                editForm.innerHTML = `
                    <div class="edit-row">
                        <label class="edit-label">Key:</label>
                        <input type="text" class="edit-input edit-key" value="${key}" readonly>
                    </div>
                    <div class="edit-row">
                        <label class="edit-label">Value:</label>
                        <input type="text" class="edit-input edit-value" value="${currentValue}">
                    </div>
                    <div class="edit-buttons">
                        <button class="edit-btn save-btn">Save</button>
                        <button class="edit-btn cancel-btn">Cancel</button>
                        <button class="edit-btn delete-btn">Delete</button>
                    </div>
                `;
                
                // Replace the spec value with the edit form
                const specValue = specItem.querySelector('.spec-value');
                specValue.style.display = 'none';
                specItem.appendChild(editForm);
                specItem.classList.add('editing');
                
                // Focus on the value input
                const valueInput = editForm.querySelector('.edit-value');
                valueInput.focus();
                valueInput.select();
                
                // Add event listeners
                editForm.querySelector('.save-btn').addEventListener('click', () => saveEdit());
                editForm.querySelector('.cancel-btn').addEventListener('click', () => cancelEdit());
                editForm.querySelector('.delete-btn').addEventListener('click', () => deleteSpec());
            }
            

            
            function saveEdit() {
                if (!editingSpec) return;
                
                const { specItem, specId, category, key } = editingSpec;
                const newValue = specItem.querySelector('.edit-value').value.trim();
                
                if (!newValue) {
                    alert('Value cannot be empty');
                    return;
                }
                
                // Update the database via API
                updateSpecification(specId, category, key, newValue)
                    .then(() => {
                        // Update the display
                        const specValue = specItem.querySelector('.spec-value');
                        specValue.textContent = newValue + ' ‚úèÔ∏è';
                        specValue.style.display = 'inline';
                        
                        // Remove edit form
                        const editForm = specItem.querySelector('.edit-form');
                        if (editForm) editForm.remove();
                        
                        specItem.classList.remove('editing');
                        editingSpec = null;
                        
                        showNotification('Specification updated successfully!', 'success');
                    })
                    .catch(error => {
                        console.error('Error updating specification:', error);
                        showNotification('Error updating specification', 'error');
                    });
            }
            

            
            function deleteSpec() {
                if (!editingSpec) return;
                
                if (!confirm('Are you sure you want to delete this specification?')) {
                    return;
                }
                
                const { specItem, specId, category, key } = editingSpec;
                
                // Delete from database via API
                deleteSpecification(specId)
                    .then(() => {
                        // Remove the spec item
                        specItem.remove();
                        editingSpec = null;
                        
                        showNotification('Specification deleted successfully!', 'success');
                    })
                    .catch(error => {
                        console.error('Error deleting specification:', error);
                        showNotification('Error deleting specification', 'error');
                    });
            }
            
            function cancelEdit() {
                if (!editingSpec) return;
                
                if (editingSpec.isNew) {
                    // Remove add form
                    editingSpec.form.remove();
                } else {
                    // Restore original display
                    const { specItem } = editingSpec;
                    const specValue = specItem.querySelector('.spec-value');
                    specValue.style.display = 'inline';
                    
                    // Remove edit form
                    const editForm = specItem.querySelector('.edit-form');
                    if (editForm) editForm.remove();
                    
                    specItem.classList.remove('editing');
                }
                
                editingSpec = null;
            }
            

            
            // API functions
            async function updateSpecification(specId, category, key, value) {
                const response = await fetch('/api/social-media/specifications/update', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ spec_id: specId, category, key, value })
                });
                
                if (!response.ok) {
                    throw new Error('Failed to update specification');
                }
                
                return response.json();
            }
            

            
            async function deleteSpecification(specId) {
                const response = await fetch('/api/social-media/specifications/delete', {
                    method: 'DELETE',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ spec_id: specId })
                });
                
                if (!response.ok) {
                    throw new Error('Failed to delete specification');
                }
                
                return response.json();
            }
            
            function showNotification(message, type) {
                // Create notification element
                const notification = document.createElement('div');
                notification.className = `alert alert-${type === 'success' ? 'success' : 'danger'} alert-dismissible fade show position-fixed`;
                notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
                notification.innerHTML = `
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                `;
                
                document.body.appendChild(notification);
                
                // Auto-remove after 5 seconds
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 5000);
            }

            // Content Process Selection Functionality
            const processSelector = document.getElementById('content-process-selector');
            const processDescription = document.getElementById('process-description');
            const processConfigPreview = document.getElementById('process-config-preview');

            // Process configuration data
            const processConfigs = {
                'facebook_feed_post': {
                    description: '<strong>Feed Post:</strong> Standard Facebook text + image posts with conversational tone. Optimized for engagement and sharing with character limits up to 63,206 characters.',
                    config: {
                        llm_prompts: 'Configured',
                        constraints: '63,206 characters max',
                        style_guide: 'Conversational, engaging',
                        hashtag_strategy: '2-3 relevant tags',
                        cta_examples: 'Multiple options',
                        status: '‚úÖ Ready for use'
                    }
                },
                'facebook_story_post': {
                    description: '<strong>Story Post:</strong> Short-form, visual content optimized for Facebook Stories. Focuses on engaging visuals with concise text under 100 characters.',
                    config: {
                        llm_prompts: 'Configured',
                        constraints: '100 characters max',
                        style_guide: 'Visual, engaging, concise',
                        hashtag_strategy: '1-2 very relevant tags',
                        cta_examples: 'Swipe up, tap for more',
                        status: '‚úÖ Ready for use'
                    }
                },
                'facebook_reels_caption': {
                    description: '<strong>Reels Caption:</strong> Video content captions optimized for Facebook Reels. Trending language with engaging calls-to-action under 150 characters.',
                    config: {
                        llm_prompts: 'Configured',
                        constraints: '150 characters max',
                        style_guide: 'Trending, energetic, engaging',
                        hashtag_strategy: '2-3 trending tags',
                        cta_examples: 'Follow, like, comment',
                        status: '‚úÖ Ready for use'
                    }
                },
                'facebook_group_post': {
                    description: '<strong>Group Post:</strong> Community-focused content for Facebook Groups. Encourages discussion and community engagement with conversational tone.',
                    config: {
                        llm_prompts: 'Configured',
                        constraints: '63,206 characters max',
                        style_guide: 'Community-oriented, discussion-focused',
                        hashtag_strategy: '2-3 relevant tags',
                        cta_examples: 'What do you think? Share your thoughts',
                        status: '‚úÖ Ready for use'
                    }
                }
            };

            // Handle process selection change
            processSelector.addEventListener('change', function() {
                const selectedProcess = this.value;
                const config = processConfigs[selectedProcess];
                
                if (config) {
                    // Update description
                    processDescription.innerHTML = config.description;
                    
                    // Update configuration preview
                    processConfigPreview.innerHTML = `
                        <div class="row">
                            <div class="col-md-6">
                                <strong>LLM Prompts:</strong> ${config.config.llm_prompts}<br>
                                <strong>Constraints:</strong> ${config.config.constraints}<br>
                                <strong>Style Guide:</strong> ${config.config.style_guide}
                            </div>
                            <div class="col-md-6">
                                <strong>Hashtag Strategy:</strong> ${config.config.hashtag_strategy}<br>
                                <strong>CTA Examples:</strong> ${config.config.cta_examples}<br>
                                <strong>Status:</strong> ${config.config.status}
                            </div>
                        </div>
                    `;
                }
            });

            // Initialize with default process
            processSelector.dispatchEvent(new Event('change'));

            // Process Configuration Panel Functionality
            const developedToggle = document.getElementById('developedToggle');
            const developedStatusText = document.getElementById('developedStatusText');
            const processConfigsContainer = document.getElementById('processConfigsContainer');
            let currentProcessId = null;

            // Handle process selection change to load configs
            processSelector.addEventListener('change', function() {
                const selectedProcess = this.value;
                if (selectedProcess) {
                    loadProcessConfigs(selectedProcess);
                }
            });

            // Load process configurations from database
            function loadProcessConfigs(processName) {
                // First get the process ID and details
                fetch('/api/syndication/content-processes')
                    .then(response => response.json())
                    .then(data => {
                        const process = data.processes.find(p => p.process_name === processName);
                        if (process) {
                            currentProcessId = process.id;
                            
                            // Update development status toggle
                            updateDevelopmentStatus(process.development_status === 'developed');
                            
                            // Load process configurations
                            fetch(`/api/syndication/content-processes/${process.id}/configs`)
                                .then(response => response.json())
                                .then(configData => {
                                    displayProcessConfigs(configData.configs);
                                })
                                .catch(error => {
                                    console.error('Error fetching configs:', error);
                                    displayProcessConfigs([]);
                                });
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching processes:', error);
                    });
            }

            // Update development status toggle
            function updateDevelopmentStatus(isDeveloped) {
                developedToggle.checked = isDeveloped;
                developedStatusText.textContent = isDeveloped ? 'Developed' : 'Not Developed';
            }

            // Display process configurations organized by category
            function displayProcessConfigs(configs) {
                if (!configs || configs.length === 0) {
                    processConfigsContainer.innerHTML = `
                        <div class="text-center text-muted py-4">
                            <i class="fas fa-exclamation-triangle me-2"></i>No configurations found for this process
                        </div>
                    `;
                    return;
                }

                // Group configs by category
                const configsByCategory = {};
                configs.forEach(config => {
                    if (!configsByCategory[config.config_category]) {
                        configsByCategory[config.config_category] = [];
                    }
                    configsByCategory[config.config_category].push(config);
                });

                // Create HTML for each category
                let html = '';
                Object.keys(configsByCategory).forEach(category => {
                    const categoryConfigs = configsByCategory[category];
                    html += `
                        <div class="config-category mb-4">
                            <h6 class="text-info mb-3">${category.replace('_', ' ').toUpperCase()}</h6>
                            <div class="row">
                    `;
                    
                    categoryConfigs.forEach(config => {
                        html += `
                            <div class="col-md-6 mb-3">
                                <div class="config-item">
                                    <label class="form-label text-white">${config.config_key.replace('_', ' ').toUpperCase()}:</label>
                                    <textarea class="form-control bg-dark text-white border-secondary" 
                                              rows="3" 
                                              data-config-id="${config.id}"
                                              data-config-key="${config.config_key}"
                                              data-config-category="${config.config_category}">${config.config_value}</textarea>
                                </div>
                            </div>
                        `;
                    });
                    
                    html += `
                            </div>
                        </div>
                    `;
                });

                processConfigsContainer.innerHTML = html;

                // Add event listeners for textarea changes
                const textareas = processConfigsContainer.querySelectorAll('textarea');
                textareas.forEach(textarea => {
                    textarea.addEventListener('blur', function() {
                        updateProcessConfig(
                            this.dataset.configId,
                            this.dataset.configCategory,
                            this.dataset.configKey,
                            this.value
                        );
                    });
                });
            }

            // Update process configuration in database
            function updateProcessConfig(configId, category, key, value) {
                fetch(`/api/syndication/content-processes/${currentProcessId}/configs`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        config_id: configId,
                        value: value
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        console.error('Error updating config:', data.error);
                        showNotification('Error updating configuration', 'danger');
                    } else {
                        showNotification('Configuration updated successfully', 'success');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    showNotification('Error updating configuration', 'danger');
                });
            }

            // Handle development status toggle
            developedToggle.addEventListener('change', function() {
                if (currentProcessId) {
                    updateProcessDevelopmentStatus(this.checked);
                }
            });

            // Update process development status in database
            function updateProcessDevelopmentStatus(isDeveloped) {
                const newStatus = isDeveloped ? 'developed' : 'draft';
                
                fetch(`/api/syndication/content-processes/${currentProcessId}/status`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        status: newStatus
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        console.error('Error updating status:', data.error);
                        showNotification('Error updating development status', 'danger');
                        // Revert the toggle
                        developedToggle.checked = !isDeveloped;
                        updateDevelopmentStatus(!isDeveloped);
                    } else {
                        showNotification('Development status updated successfully', 'success');
                        updateDevelopmentStatus(isDeveloped);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    showNotification('Error updating development status', 'danger');
                    // Revert the toggle
                    developedToggle.checked = !isDeveloped;
                    updateDevelopmentStatus(!isDeveloped);
                });
            }

            // Initialize with default process configs
            loadProcessConfigs('facebook_feed_post');
        });
    </script>
</body>
</html>
