{% extends "base.html" %}

{% block title %}Blog Posts{% endblock %}

{% block styles %}
<style>
    .gradient-header {
        background: linear-gradient(90deg, #23273a 0%, #181c2a 100%);
        border: 1px solid #31364a;
        box-shadow: 0 4px 24px 0 rgba(0, 0, 0, 0.45);
    }

    .icon-circle {
        background: #23273a;
        border-radius: 9999px;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 3rem;
        height: 3rem;
        box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.25);
    }

    .card-dark {
        background: #181c2a;
        border: 1px solid #31364a;
        color: #e0e0e0;
        box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.25);
    }

    .card-dark:hover {
        background: #23273a;
        border-color: #6366f1;
    }

    .section-title {
        color: #a5b4fc;
        font-weight: 700;
    }

    .input-dark {
        background: #23273a;
        color: #e0e0e0;
        border: 1px solid #31364a;
    }

    .input-dark:focus {
        border-color: #6366f1;
        outline: none;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-8">Blog Posts</h1>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for post in posts %}
        <div class="bg-dark-bg border border-dark-border rounded-lg shadow-lg overflow-hidden">
            <div class="p-6">
                <h2 class="text-xl font-semibold mb-4">{{ post.title }}</h2>
                <div class="flex justify-between items-center">
                    <a href="{{ url_for('workflow_nav.stage', stage='planning', substage='idea', post_id=post.id) }}"
                        class="text-dark-accent hover:text-dark-text transition">
                        View Workflow
                    </a>
                    <a href="{{ url_for('blog.post', post_id=post.id) }}"
                        class="text-dark-accent hover:text-dark-text transition">
                        View Post
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
    // Floating new post button logic
    const newPostBtn = document.getElementById('floatingNewPostBtn');
    if (newPostBtn) {
        newPostBtn.addEventListener('click', async () => {
            const basicIdea = prompt('Enter your basic idea for the post:');
            if (!basicIdea) return;
            try {
                const response = await fetch('/blog/new', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ basic_idea: basicIdea })
                });
                const data = await response.json();
                if (data && data.id) {
                    window.location.href = `{{ url_for('workflow_nav.stage', stage='planning', substage='idea') }}?post_id=${data.id}`;
                } else {
                    alert('Failed to create post');
                }
            } catch (err) {
                alert('Error creating post');
            }
        });
    }
</script>
{% endblock %}