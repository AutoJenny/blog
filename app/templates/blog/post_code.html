{% extends "blog/post_base.html" %}

{% block post_content %}
<div class="code-view">
    <!-- Meta Information -->
    <div class="accordion mb-4" id="metaAccordion">
        <div class="accordion-item">
            <h2 class="accordion-header" id="metaHeader">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#metaCollapse">
                    Meta Information
                </button>
            </h2>
            <div id="metaCollapse" class="accordion-collapse collapse show" data-bs-parent="#metaAccordion">
                <div class="accordion-body">
                    <pre class="bg-light p-3 rounded"><code>
{
    "id": {{ post.id }},
    "title": {{ post.title | tojson }},
    "slug": {{ post.slug | tojson }},
    "created_at": {{ post.created_at.isoformat() | tojson }},
    "updated_at": {{ post.updated_at.isoformat() | tojson }},
    "published": {{ post.published | tojson }},
    "author_id": {{ post.author_id }},
    "deleted": {{ post.deleted | tojson }}
}
                    </code></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- Header Content -->
    <div class="accordion mb-4" id="headerAccordion">
        <div class="accordion-item">
            <h2 class="accordion-header" id="headerHeader">
                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                    data-bs-target="#headerCollapse">
                    Header Content
                </button>
            </h2>
            <div id="headerCollapse" class="accordion-collapse collapse show" data-bs-parent="#headerAccordion">
                <div class="accordion-body">
                    <pre class="bg-light p-3 rounded"><code>
{
    "summary": {{ post.summary | default('') | tojson }},
    "content": {{ post.content | default('') | tojson }}
}
                    </code></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- Sections -->
    {% if post.sections %}
    <div class="accordion mb-4" id="sectionsAccordion">
        <div class="accordion-item">
            <h2 class="accordion-header" id="sectionsHeader">
                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                    data-bs-target="#sectionsCollapse">
                    Sections ({{ post.sections|length }})
                </button>
            </h2>
            <div id="sectionsCollapse" class="accordion-collapse collapse show" data-bs-parent="#sectionsAccordion">
                <div class="accordion-body">
                    {% for section in post.sections %}
                    <div class="card mb-3">
                        <div class="card-header">
                            Section {{ loop.index }}
                        </div>
                        <div class="card-body">
                            <pre class="bg-light p-3 rounded"><code>
{
    "id": {{ section.id }},
    "title": {{ section.title | default('') | tojson }},
    "subtitle": {{ section.subtitle | default('') | tojson }},
    "content": {{ section.content | default('') | tojson }},
    "position": {{ section.position }},
    {% if section.metadata %}
    "metadata": {{ section.metadata | tojson if section.metadata is string else section.metadata | string | tojson }},
    {% endif %}
    {% if section.social_media_snippets %}
    "social_media_snippets": {{ section.social_media_snippets | tojson if section.social_media_snippets is string else section.social_media_snippets | string | tojson }},
    {% endif %}
    "created_at": {{ section.created_at.isoformat() if section.created_at else '' | tojson }},
    "updated_at": {{ section.updated_at.isoformat() if section.updated_at else '' | tojson }}
}
                            </code></pre>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Additional Metadata -->
    <div class="accordion mb-4" id="additionalAccordion">
        <div class="accordion-item">
            <h2 class="accordion-header" id="additionalHeader">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                    data-bs-target="#additionalCollapse">
                    Additional Metadata
                </button>
            </h2>
            <div id="additionalCollapse" class="accordion-collapse collapse" data-bs-parent="#additionalAccordion">
                <div class="accordion-body">
                    <pre class="bg-light p-3 rounded"><code>
{
    {% if post.categories %}
    "categories": [
        {% for category in post.categories %}
        {
            "id": {{ category.id }},
            "name": {{ category.name | tojson }},
            "slug": {{ category.slug | tojson }}
        }{% if not loop.last %},{% endif %}
        {% endfor %}
    ],
    {% endif %}
    {% if post.tags %}
    "tags": [
        {% for tag in post.tags %}
        {
            "id": {{ tag.id }},
            "name": {{ tag.name | tojson }}
        }{% if not loop.last %},{% endif %}
        {% endfor %}
    ],
    {% endif %}
    {% if post.workflow_status %}
    "workflow_status": {
        "id": {{ post.workflow_status.id }},
        "current_stage": {{ post.workflow_status.current_stage.value | tojson }},
        "last_updated": {{ post.workflow_status.last_updated.isoformat() if post.workflow_status.last_updated else '' | tojson }}
    }
    {% endif %}
}
                    </code></pre>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}